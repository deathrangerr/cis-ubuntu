---

#---------------------------------------------- Section 1 Initial Setup --------------------------------------------------#
ubuntu2004cis_section1: true

ubuntu2004cis_rule_1_1_1_1: true
ubuntu2004cis_rule_1_1_1_2: true
ubuntu2004cis_rule_1_1_1_3: true
ubuntu2004cis_rule_1_1_1_4: true
ubuntu2004cis_rule_1_1_1_5: true
ubuntu2004cis_rule_1_1_1_6: true
ubuntu2004cis_rule_1_1_1_7: true

ubuntu2004cis_rule_1_1_2: true
ubuntu2004cis_rule_1_1_3: true
ubuntu2004cis_rule_1_1_4: true
ubuntu2004cis_rule_1_1_5: true
ubuntu2004cis_rule_1_1_6: true
ubuntu2004cis_rule_1_1_7: true
ubuntu2004cis_rule_1_1_8: true
ubuntu2004cis_rule_1_1_9: true
ubuntu2004cis_rule_1_1_10: true
ubuntu2004cis_rule_1_1_11: true
ubuntu2004cis_rule_1_1_12: true
ubuntu2004cis_rule_1_1_13: true
ubuntu2004cis_rule_1_1_14: true
ubuntu2004cis_rule_1_1_15: true
ubuntu2004cis_rule_1_1_16: true
ubuntu2004cis_rule_1_1_17: false
ubuntu2004cis_rule_1_1_18: false
ubuntu2004cis_rule_1_1_19: false
ubuntu2004cis_rule_1_1_20: false
ubuntu2004cis_rule_1_1_21: false
ubuntu2004cis_rule_1_1_22: true
ubuntu2004cis_rule_1_1_23: true
ubuntu2004cis_rule_1_1_24: true

ubuntu2004cis_rule_1_2_1: true
ubuntu2004cis_rule_1_2_2: true

ubuntu2004cis_rule_1_3_1: true
ubuntu2004cis_rule_1_3_2: true

ubuntu2004cis_rule_1_4_1: true
ubuntu2004cis_rule_1_4_2: false
ubuntu2004cis_rule_1_4_3: true
ubuntu2004cis_rule_1_4_4: true

ubuntu2004cis_rule_1_5_1: true
ubuntu2004cis_rule_1_5_2: true
ubuntu2004cis_rule_1_5_3: true
ubuntu2004cis_rule_1_5_4: true

ubuntu2004cis_rule_1_6_1_1: true
ubuntu2004cis_rule_1_6_1_2: true
ubuntu2004cis_rule_1_6_1_3: true
ubuntu2004cis_rule_1_6_1_4: true

ubuntu2004cis_rule_1_7_1: true
ubuntu2004cis_rule_1_7_2: true
ubuntu2004cis_rule_1_7_3: true
ubuntu2004cis_rule_1_7_4: true
ubuntu2004cis_rule_1_7_5: true
ubuntu2004cis_rule_1_7_6: true

ubuntu2004cis_rule_1_8_1: false
ubuntu2004cis_rule_1_8_2: false
ubuntu2004cis_rule_1_8_3: false
ubuntu2004cis_rule_1_8_4: false

ubuntu2004cis_rule_1_9: false


ubuntu2004cis_tmp_fstab_options: "defaults,rw,nosuid,nodev,noexec,relatime,size=2G"
ubuntu2004cis_dev_shm_fstab_options: "defaults,noexec,nodev,nosuid"
ubuntu2004cis_dev_xvdf2_fstab_options: "defaults,noexec,nodev,nosuid"

ubuntu2004_partition_count: 4
# Service configuration variables, set to true to keep service
ubuntu2004cis_allow_autofs: false

# Control 1.3.1 - allow aide to be configured
ubuntu2004cis_config_aide: true
# AIDE cron settings
ubuntu2004cis_aide_cron:
  cron_user: root
  cron_file: aide
  aide_job: '/usr/bin/aide.wrapper --config /etc/aide/aide.conf --check'
  aide_minute: 0
  aide_hour: 5
  aide_day: '*'
  aide_month: '*'
  aide_weekday: '*'

# 1.4.2 Bootloader password
ubuntu2004cis_bootloader_password: random
ubuntu2004cis_set_boot_pass: false

# Variables for 1.5.4
# Control 1.4.4
# THIS VARAIBLE SHOULD BE CHANGED AND INCORPORATED INTO VAULT
# THIS VALUE IS WHAT THE ROOT PW WILL BECOME!!!!!!!!
# HAVING THAT PW EXPOSED IN RAW TEXT IS NOT SECURE!!!!
ubuntu2004cis_root_pw: "root123"

# Variables for 1.5.4
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_path: /etc/security/limits.conf
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_line: '* hard core 0'
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_regexp: .*\*.*hard.*core.*[0-9]
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_state: present
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_owner: root
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_group: root
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_security_limit_mode: '0544'
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_kernel_parameter_name: fs.suid_dumpable
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_kernel_parameter_value: '0'
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_kernel_parameter_state: present
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_kernel_parameter_reload: yes
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_kernel_parameter_sysctl_set: yes
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_package_name: systemd-coredump
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_package_state: present
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_path: /etc/systemd/coredump.conf
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_section: Coredump
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_storage_option: Storage
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_storage_value: none
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_processsizemax_option: ProcessSizeMax
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_processsizemax_value: '0'
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_owner: root
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_group: root
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_mode: '0544'
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_state: present
ubuntu_2004_cis_section1_rule_1_5_4_params_core_dump_service_conf_no_extra_spaces: yes

# Variables for 1.7
# Control 1.7
# This will be the motd banner must not contain the below items in order to be compliant with Ubuntu 20 CIS
# \m, \r, \s, \v or references to the OS platform
ubuntu2004cis_warning_banner: |
        Authorized uses only. All activity may be monitored and reported.

# Variables for 1.8.2
# Control 1.8.2
# ubuntu2004cis_desktop_required is the toggle for requiring desktop environments. True means you use a desktop and will not disable/remove needed items to run a desktop (not recommented for servers)
# false means you do not require a desktop
ubuntu2004cis_desktop_required: false


#---------------------------------------------- Section 2 Services --------------------------------------------------#
ubuntu2004cis_section2: true

ubuntu2004cis_rule_2_1_1_1: false
ubuntu2004cis_rule_2_1_1_2: false
ubuntu2004cis_rule_2_1_1_3: false
ubuntu2004cis_rule_2_1_1_4: false
ubuntu2004cis_rule_2_1_2: true
ubuntu2004cis_rule_2_1_3: true
ubuntu2004cis_rule_2_1_4: true
ubuntu2004cis_rule_2_1_5: true
ubuntu2004cis_rule_2_1_6: true
ubuntu2004cis_rule_2_1_7: true
ubuntu2004cis_rule_2_1_8: true
ubuntu2004cis_rule_2_1_9: true
ubuntu2004cis_rule_2_1_10: false
ubuntu2004cis_rule_2_1_11: true
ubuntu2004cis_rule_2_1_12: true
ubuntu2004cis_rule_2_1_13: false
ubuntu2004cis_rule_2_1_14: true
ubuntu2004cis_rule_2_1_15: true
ubuntu2004cis_rule_2_1_16: true
ubuntu2004cis_rule_2_1_17: true

ubuntu2004cis_rule_2_2_1: true
ubuntu2004cis_rule_2_2_2: true
ubuntu2004cis_rule_2_2_3: true
ubuntu2004cis_rule_2_2_4: false
ubuntu2004cis_rule_2_2_5: true
ubuntu2004cis_rule_2_2_6: true

ubuntu2004cis_rule_2_3: false
# Variables for 2.1
# The two options are chrony, ntp, or systemd-timesyncd
ubtuntu2004cis_time_sync_tool: "ntp"

# Variables for 2.1.1.2
# ubuntu2004cis_ntp_server_list is the list ntp servers
# ubuntu2004cis_ntp_fallback_server_list is the list of fallback NTP servers
ubuntu2004cis_ntp_server_list: "0.debian.pool.ntp.org 1.debian.pool.ntp.org"
ubuntu2004cis_ntp_fallback_server_list: "2.debian.pool.ntp.org 3.debian.pool.ntp.org"

# Variable 2.1.1.3/2.1.1.4
ubuntu2004cis_chrony_server_options: "minpoll 8"
# ubutnu2004cis_time_synchronization_servers are the synchronization servers
ubuntu2004cis_time_synchronization_servers:
    - 0.pool.ntp.org
    - 1.pool.ntp.org
    - 2.pool.ntp.org
    - 3.pool.ntp.org
# ubuntu2004cis_chrony_user is the user that chrony will use, default is _chrony
ubuntu2004cis_chrony_user: "_chrony"
# ubuntu2004cis_ntp_server_options is the server options for ntp
ubuntu2004cis_ntp_server_options: "iburst"
# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
# Value of true runs duscruptive tasks, value of false will skip disruptive tasks
ubuntu2004cis_disruption_high: true
# Service configuration variables, set to true to keep service
ubuntu2004cis_avahi_server: false
ubuntu2004cis_cups_server: false
ubuntu2004cis_dhcp_server: false
ubuntu2004cis_ldap_server: false
ubuntu2004cis_nfs_server: false
ubuntu2004cis_dns_server: false
ubuntu2004cis_vsftpd_server: false
ubuntu2004cis_httpd_server: false
ubuntu2004cis_dovecot_server: false
ubuntu2004cis_smb_server: false
ubuntu2004cis_squid_server: false
ubuntu2004cis_snmp_server: false
ubuntu2004cis_is_mail_server: false
ubuntu2004cis_rsync_server: false
ubuntu2004cis_nis_server: false
ubuntu2004cis_nfs_client: false
# rpcbind is required by nfs-common which is required on client and server
ubuntu2004cis_rpc_required: "{{ ubuntu2004cis_nfs_server or ubuntu2004cis_nfs_client }}"
# Clients in use variables
ubuntu2004cis_nis_required: false
ubuntu2004cis_rsh_required: false
ubuntu2004cis_talk_required: false
ubuntu2004cis_telnet_required: false
ubuntu2004cis_ldap_clients_required: false
ubuntu2004cis_is_router: false






